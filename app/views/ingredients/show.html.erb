<div class="list_recipes container">
<h3 class="recipes"><span class="ingredientName"><%= @ingredient.name %></span></h3>

<% if !@ingredient.recipes.empty? %>
  <h5 class="recipes">Used in these recipes:</h5>
  <ul class="list_recipes ingredient_recipes">
  <% @ingredient.recipes.each do |recipe| %>
    <li class="list_ingredients ingredient_recipes"> <%= link_to recipe.name, recipe_path(recipe) %> </li>
  <% end %>
  </ul>
<% end %>

<% if !@ingredient.nutrients.empty? %>
  <h5 class="recipes"> Contains these nutrients: </h5>
  <ul class="list_recipes ingredient_nutrients">
  <% @ingredient.nutrients.each do |nutrient| %>
    <li class="list_ingredients ingredient_nutrients"> <%= link_to nutrient.name, nutrient_path(nutrient) %> </li>
  <% end %>
  </ul>
<% end %>

<h5 class="recipes">  <%= link_to "Edit this ingredient", edit_ingredient_path(@ingredient) %><h5>
</div>

<a href="#" class="js-previous_ingredient" data-id="<%=@ingredient.id%>">Previous Ingredient</a>
<a href="#" class="js-next_ingredient" data-id="<%=@ingredient.id%>">Next Ingredient</a>


<script type="text/javascript" charset="utf-8">

$(function() {
  $(".js-next_ingredient").on("click", function(event) {
    nextIngredient(event);
  })
  $(".js-previous_ingredient").on("click", function(event) {
    previousIngredient(event);
  })
});


function nextIngredient(event) {
    event.preventDefault();
    var nextId = parseInt($(".js-next_ingredient").attr("data-id")) + 1;
    $.get("/ingredients/" + nextId + "/data").success(function(data) {
      $(".ingredientName").text(data["name"]);
      if (data["recipes"]) {
        $(".ingredient_recipes").empty();
        data["recipes"].forEach(function(element){
          $(".ingredient_recipes").append('<li class="list"><a href="/recipes/' + element.id + '">' + element.name + '</a></li>');
        })
        $(".ingredient_nutrients").empty();
        data["nutrients"].forEach(function(element){
          $(".ingredient_nutrients").append('<li class="list"><a href="/nutrients/' + element.id + '">' + element.name + '</a></li>');
        })
        // re-set the id to current on the link
        $(".js-next_ingredient").attr("data-id", data["id"]);
      }
    });
};

function previousIngredient(event) {
    event.preventDefault();
    var nextId = parseInt($(".js-next_ingredient").attr("data-id")) - 1;
    $.get("/ingredients/" + nextId + "/data").success(function(data) {
      $(".ingredientName").text(data["name"]);
      if (data["recipes"]) {
        $(".ingredient_recipes").empty();
        data["recipes"].forEach(function(element){
          $(".ingredient_recipes").append('<li class="list"><a href="/recipes/' + element.id + '">' + element.name + '</a></li>');
        })
      if (data["nutrients"]) {
        $(".ingredient_nutrients").empty();
        data["nutrients"].forEach(function(element){
          $(".ingredient_nutrients").append('<li class="list"><a href="/nutrients/' + element.id + '">' + element.name + '</a></li>');
        })
      }
        // re-set the id to current on the link
        $(".js-next_ingredient").attr("data-id", data["id"]);
      }
    });
};

</script>
